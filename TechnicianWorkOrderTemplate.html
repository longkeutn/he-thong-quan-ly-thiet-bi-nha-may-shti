<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body {
      font-family: Arial, sans-serif;
      font-size: 12px;
      margin: 0;
      padding: 15px;
    }
    .header {
      text-align: center;
      margin-bottom: 15px;
      border-bottom: 1px solid #333;
      padding-bottom: 10px;
    }
    .date-shift {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #333;
      padding: 5px;
    }
    th {
      background-color: #f2f2f2;
      text-align: center;
    }
    .priority-high {
      background-color: #ffdddd;
    }
    .priority-medium {
      background-color: #ffffcc;
    }
    .signature {
      margin-top: 30px;
      display: flex;
      justify-content: space-between;
    }
    .signature div {
      width: 200px;
      text-align: center;
    }
    .signature-line {
      border-top: 1px solid #333;
      margin-top: 50px;
    }
    .checkbox {
      width: 15px;
      height: 15px;
      border: 1px solid #333;
      display: inline-block;
      vertical-align: middle;
    }
    .notes {
      height: 40px;
      border-bottom: 1px dotted #333;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h2>PHIẾU CÔNG VIỆC ĐẦU CA - ĐỘI KỸ THUẬT</h2>
  </div>
  
  <div class="date-shift">
    <div><strong>Ngày:</strong> <?= Utilities.formatDate(new Date(), "GMT+7", "dd/MM/yyyy") ?></div>
    <div>
      <strong>Ca:</strong> 
      <span class="checkbox"></span> Sáng
      <span class="checkbox"></span> Chiều
      <span class="checkbox"></span> Tối
    </div>
  </div>
  
  <table>
    <tr>
      <th width="5%">STT</th>
      <th width="10%">Mã Phiếu</th>
      <th width="12%">Đối tượng</th>
      <th width="15%">Vị trí</th>
      <th width="10%">Loại CV</th>
      <th width="25%">Mô tả YC/Vấn đề</th>
      <th width="8%">Ưu tiên</th>
      <th width="15%">Kết quả/Ghi chú</th>
    </tr>
    <? for (var i = 0; i < workOrders.length; i++) { 
         var priorityClass = "";
         if (workOrders[i].priority === "Cao") priorityClass = "priority-high";
         else if (workOrders[i].priority === "Trung bình") priorityClass = "priority-medium";
    ?>
    <tr class="<?= priorityClass ?>">
      <td align="center"><?= i+1 ?></td>
      <td><?= workOrders[i].id ?></td>
      <td><?= workOrders[i].target ?></td>
      <td><?= workOrders[i].location ?></td>
      <td><?= workOrders[i].workType ?></td>
      <td><?= workOrders[i].description ?></td>
      <td align="center"><?= workOrders[i].priority ?></td>
      <td>
        <div class="notes"></div>
      </td>
    </tr>
    <? } ?>
  </table>
  
  <div class="signature">
    <div>
      <div class="signature-line"></div>
      <p>Trưởng ca kỹ thuật</p>
    </div>
    <div>
      <div class="signature-line"></div>
      <p>Người giao việc</p>
    </div>
  </div>
</body>
</html>
